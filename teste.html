<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <title>Calcular Preço Médio</title>
</head>

<body>
  <h3>Cadastrar Produto</h3>

  <label for="custo">Custo (R$):</label>
  <input type="text" id="custo" placeholder="Ex: 3.490,90" oninput="calcularPrecoMedio()">

  <br><br>

  <label for="quantidade">Quantidade:</label>
  <input type="number" id="quantidade" placeholder="Ex: 5" oninput="calcularPrecoMedio()">

  <br><br>

  <label for="preco_medio">Preço Médio:</label>
  <input type="text" id="preco_medio" readonly>

  <script>
    function calcularPrecoMedio() {
      const custoInput = document.getElementById('custo');
      const quantidadeInput = document.getElementById('quantidade');
      const precoMedioInput = document.getElementById('preco_medio');

      function converterParaNumero(valor) {
        if (!valor) return 0;
        return parseFloat(valor.replace(/\./g, '').replace(',', '.')) || 0;
      }

      function formatarComoReal(valor) {
        return valor.toFixed(2)
          .replace('.', ',')
          .replace(/\B(?=(\d{3})+(?!\d))/g, '.');
      }

      const custo = converterParaNumero(custoInput.value);
      const quantidade = parseFloat(quantidadeInput.value) || 0;

      if (custo <= 0 || quantidade <= 0) {
        precoMedioInput.value = '';
        return;
      }

      const precoMedio = Math.floor((custo / quantidade) * 100) / 100;
      precoMedioInput.value = formatarComoReal(precoMedio);
    }
  </script>
</body>

</html>